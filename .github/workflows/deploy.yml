name: Notify vela controller repo

on:
  workflow_run:
    workflows: ['Build and publish image']
    types:
      - completed

jobs:
  dispatch:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    runs-on: ubuntu-latest
    steps:
      - name: Send repository_dispatch event
        uses: peter-evans/repository-dispatch@v4
        with:
          token: ${{ secrets.PRIVATE_REPO_PAT }}
          repository: simplyblock/vela-controller
          event-type: update-vela-studio
          client-payload: '{"sha": "${{ github.event.workflow_run.head_sha }}"}'
